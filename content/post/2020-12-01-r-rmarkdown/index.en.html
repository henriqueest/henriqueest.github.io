---
title: 'Non-linear growth models'
#subtitle: "ajustes e saídas gráficas no R"
date: "2022-03-31"
type: book
output:
  html_document:
    df_print: paged
weight: 20
---

<script src="{{< blogdown/postref >}}index.en_files/header-attrs/header-attrs.js"></script>


<div id="non-linear-models" class="section level2">
<h2>Non-linear models</h2>
<p>Nonlinear models (NLM) usually go back to obtaining some information about the relationship between variables Y and X. Such information is linked to different degrees of knowledge as
- an analysis of a scatterplot of Y v.s. X
- shape constraints of the function (monotone, sigmoid)
- the solution of a differential equation supported by some
principle or theory
- the interpretation of its parameters.</p>
<p>Whatever the degree of knowledge, the choice of a nonlinear model is rarely empirical.</p>
<p>A growing number of researchers share the feeling that relationships between biological variables are best described by nonlinear functions. Processes such as growth, decay, birth, mortality, competition and production are rarely linearly related to explanatory variables (SCHABENBERGER; PIERCE, 2002).</p>
<p>In this sense, it can be said that MNL best
they describe mechanistic processes and are useful in accommodating constraints regarding such processes. In summary, MNLs have the following advantages over
linear models (ML)
- your choice is supported by theory or mechanistic principles (physical, chemical or biological) or any other prior information
- certain parameters are amount of interest to the researcher provided with interpretation
- predictions can be made outside the observed domain of x
- are parsimonious as they typically have fewer parameters
- depart from the researcher’s knowledge of the target phenomenon.</p>
<p>On the other hand, the disadvantages are:
- require iterative estimation procedures based on providing initial values for parameters
Inference methods are approximate
- Require knowledge of the researcher about the target phenomenon.</p>
<div id="parameter-interpretation" class="section level3">
<h3>Parameter interpretation</h3>
<p>When assuming MNL to describe a process, it is essential to know the meaning of its parameters. In addition to dimensionality, the study of parametric space is equally important as it allows recognizing the values that a parameter assumes. Many processes involve positive variables, such as time, dose, production, speed, and limited variables, typically represented in percentage, such as content (%), concentration (%) and yield (%).</p>
<p>Relevant properties of a function are things like having points
characteristics (critical, inflection), their behavior (concavity, monoticity) or appear specific patterns (sigmoid, parabolic).</p>
<p>Some of these properties, starting with the characteristic points related to the coordinate (Y) axis, are known as
- <strong>ASS</strong>: upper asymptote
- <strong>ASI</strong>: lower asymptote
- <strong>PO</strong>: point of origin or intercept.</p>
<p>Among the characteristic points on the abscissa axis (X) are:
- <strong>PC</strong>: critical point
- <strong>PI</strong>: inflection point
- <strong>PS</strong>: point of symmetry</p>
<p>The symbol for each of these parameters will depend on the model considered. Sometimes it is faster to recognize the properties of a function by its appearance with some specific pattern. Among the most common is
- <strong>SIG</strong>: sigmoid, being monotonous increasing (MC) or decreasing (MD). The curve has an inverted S or S shape. Every sigmoid has <strong>PI</strong>, <strong>ASS</strong> and <strong>ASI</strong>.</p>
</div>
</div>
<div id="code-r" class="section level2">
<h2>Code R</h2>
<p>To install and load it in IDE’s R or rstudio, just run the following command lines.</p>
<pre class="r"><code>library(covid19br)
library(tidyverse)
library(dplyr)</code></pre>
<pre class="r"><code>data &lt;- downloadCovid19(&quot;world&quot;) %&gt;%
  filter(country == &quot;Italy&quot;)%&gt;%
  select(date, country, accumCases, accumDeaths)
glimpse(data)</code></pre>
<pre><code>## Rows: 798
## Columns: 4
## $ date        &lt;date&gt; 2020-01-22, 2020-01-23, 2020-01-24, 2020-01-25, 2020-01-2~
## $ country     &lt;chr&gt; &quot;Italy&quot;, &quot;Italy&quot;, &quot;Italy&quot;, &quot;Italy&quot;, &quot;Italy&quot;, &quot;Italy&quot;, &quot;Ita~
## $ accumCases  &lt;int&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3~
## $ accumDeaths &lt;int&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0~</code></pre>
<div id="behavior-of-accumulated-deaths-italy" class="section level3">
<h3>Behavior of accumulated deaths (Italy)</h3>
<pre class="r"><code>ggplot(data)+
  geom_point(aes(x = as.Date(date), y = accumDeaths), colour = &quot;steelblue&quot;)+
  labs(x = &quot;Date (day)&quot;, y = &quot;Accumulated deaths&quot;)+
  theme_classic()</code></pre>
<p><img src="{{< blogdown/postref >}}index.en_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<p>Suggests double sigmoid model</p>
<pre class="r"><code>ggplot(data)+
  geom_point(aes(x = as.Date(date), y = accumDeaths), colour = &quot;steelblue&quot;)+
  geom_vline(aes(x = as.Date(date), y = accumDeaths, xintercept = as.Date(&quot;2020-10-20&quot;)),
             colour=&quot;brown&quot;, linetype = &quot;longdash&quot;)+
  geom_vline(aes(x = as.Date(date), y = accumDeaths, xintercept = as.Date(&quot;2021-12-15&quot;)),
             colour=&quot;brown&quot;, linetype = &quot;longdash&quot;)+
 annotate(&quot;text&quot;, label = &quot;sigmoid behavior&quot;, x = as.Date(&quot;2020-05-1&quot;), y = 100000, size = 5,
          colour = &quot;gray&quot;)+
 annotate(&quot;text&quot;, label = &quot;sigmoid behavior&quot;, x = as.Date(&quot;2021-08-1&quot;), y = 100000, size = 5, 
          colour = &quot;gray&quot;)+
  labs(x = &quot;Date (day)&quot;, y = &quot;Accumulated deaths&quot;)+
  theme_classic()</code></pre>
<p><img src="{{< blogdown/postref >}}index.en_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
</div>
<div id="double-sigmoid-model-adjustment" class="section level3">
<h3>Double sigmoid model adjustment</h3>
<ul>
<li>Transforming the date variable into numeric.</li>
</ul>
<pre class="r"><code>n &lt;- nrow(data)
data &lt;- data %&gt;%
  mutate(data = c(seq(1,n,1)))
glimpse(data)</code></pre>
<pre><code>## Rows: 798
## Columns: 5
## $ date        &lt;date&gt; 2020-01-22, 2020-01-23, 2020-01-24, 2020-01-25, 2020-01-2~
## $ country     &lt;chr&gt; &quot;Italy&quot;, &quot;Italy&quot;, &quot;Italy&quot;, &quot;Italy&quot;, &quot;Italy&quot;, &quot;Italy&quot;, &quot;Ita~
## $ accumCases  &lt;int&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3~
## $ accumDeaths &lt;int&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0~
## $ data        &lt;dbl&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17,~</code></pre>
<ul>
<li>Changing the data scale to avoid over/under-flow issues.</li>
</ul>
<pre class="r"><code>data_mod &lt;- data %&gt;%
  select(accumDeaths, data) %&gt;%
  mutate(accumDeathscorr = accumDeaths/10000,
         data = data/100)
glimpse(data_mod)</code></pre>
<pre><code>## Rows: 798
## Columns: 3
## $ accumDeaths     &lt;int&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ~
## $ data            &lt;dbl&gt; 0.01, 0.02, 0.03, 0.04, 0.05, 0.06, 0.07, 0.08, 0.09, ~
## $ accumDeathscorr &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ~</code></pre>
<ul>
<li>Behavior of the transformed data</li>
</ul>
<pre class="r"><code>ggplot(data_mod)+
  geom_point(aes(x = data, y = accumDeathscorr), colour = &quot;steelblue&quot;)+
  geom_vline(aes(x = data, y = accumDeathscorr, xintercept = 3),
             colour=&quot;brown&quot;, linetype = &quot;longdash&quot;)+
  geom_vline(aes(x = data, y = accumDeathscorr, xintercept = 7),
             colour=&quot;brown&quot;, linetype = &quot;longdash&quot;)+
 annotate(&quot;text&quot;, label = &quot;sigmoid behavior&quot;, x = 1.5, y = 10, size = 5,
          colour = &quot;gray&quot;)+
 annotate(&quot;text&quot;, label = &quot;sigmoid behavior&quot;, x = 5.5, y = 10, size = 5, 
          colour = &quot;gray&quot;)+
  labs(x = &quot;Day&quot;, y = &quot;Accumulated deaths corrected&quot;)+
  theme_classic()</code></pre>
<p><img src="{{< blogdown/postref >}}index.en_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
</div>
</div>
<div id="starting-kicks-for-each-sigmoid" class="section level2">
<h2>Starting kicks for each sigmoid</h2>
<ul>
<li>model one: logistic model</li>
</ul>
<pre class="r"><code>apropos(&quot;^SS&quot;)</code></pre>
<pre><code>##  [1] &quot;SSasymp&quot;     &quot;SSasympOff&quot;  &quot;SSasympOrig&quot; &quot;SSbiexp&quot;     &quot;SSD&quot;        
##  [6] &quot;SSfol&quot;       &quot;SSfpl&quot;       &quot;SSgompertz&quot;  &quot;SSlogis&quot;     &quot;SSmicmen&quot;   
## [11] &quot;SSweibull&quot;</code></pre>
<pre class="r"><code>n0 &lt;- nls(accumDeathscorr ~ SSlogis(data, A, M, S), data = data_mod, 
          subset = data &lt; 3)
coef(n0)</code></pre>
<pre><code>##         A         M         S 
## 3.5857409 0.8126909 0.1364505</code></pre>
<pre class="r"><code>data_modn0 &lt;- data_mod %&gt;%
  filter(data &lt; 3) %&gt;%
  mutate(predict = predict(n0))
ggplot(data_modn0)+
geom_point(aes(x = data, y = accumDeathscorr, color = &quot;blue&quot;))+
  geom_line(aes(x = data, y = predict, color = &quot;red&quot;))+
  labs(x = &quot;data&quot;, y = &quot;Accumulated deaths&quot;)+
  theme_bw()+
  theme(legend.position=&quot;right&quot;, 
        legend.box = &quot;horizontal&quot;,legend.title=element_text(size=15), 
        legend.text=element_text(size=15), axis.text=element_text(size=20),
        axis.title=element_text(size=20), axis.line = element_line(colour = &quot;black&quot;),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.border = element_blank(),
        panel.background = element_blank()) +
  scale_color_manual(values=c(&quot;blue&quot;, &quot;red&quot;), 
                       name=&quot;Accumulated deaths&quot;,
                     breaks = c(&quot;blue&quot;, &quot;red&quot;),
                       labels=c(&quot;Observed&quot;, &quot;Predict&quot;))</code></pre>
<p><img src="{{< blogdown/postref >}}index.en_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<ul>
<li>model two: logistic model</li>
</ul>
<pre class="r"><code>apropos(&quot;^SS&quot;)</code></pre>
<pre><code>##  [1] &quot;SSasymp&quot;     &quot;SSasympOff&quot;  &quot;SSasympOrig&quot; &quot;SSbiexp&quot;     &quot;SSD&quot;        
##  [6] &quot;SSfol&quot;       &quot;SSfpl&quot;       &quot;SSgompertz&quot;  &quot;SSlogis&quot;     &quot;SSmicmen&quot;   
## [11] &quot;SSweibull&quot;</code></pre>
<pre class="r"><code>n1 &lt;- nls(accumDeathscorr ~ SSlogis(data, A, M, S), data = data_mod, 
          subset = data &gt; 3 &amp; data &lt; 7)
coef(n1)</code></pre>
<pre><code>##          A          M          S 
## 13.3237430  3.3364864  0.6323343</code></pre>
<pre class="r"><code>data_modn1 &lt;- data_mod %&gt;%
  filter(data &gt; 3 &amp; data &lt; 7) %&gt;%
  mutate(predict = predict(n1))
ggplot(data_modn1)+
geom_point(aes(x = data, y = accumDeathscorr, color = &quot;blue&quot;))+
  geom_line(aes(x = data, y = predict, color = &quot;red&quot;))+
  labs(x = &quot;data&quot;, y = &quot;Accumulated deaths&quot;)+
  theme_bw()+
  theme(legend.position=&quot;right&quot;, 
        legend.box = &quot;horizontal&quot;,legend.title=element_text(size=15), 
        legend.text=element_text(size=15), axis.text=element_text(size=20),
        axis.title=element_text(size=20), axis.line = element_line(colour = &quot;black&quot;),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.border = element_blank(),
        panel.background = element_blank()) +
  scale_color_manual(values=c(&quot;blue&quot;, &quot;red&quot;), 
                       name=&quot;Accumulated deaths&quot;,
                     breaks = c(&quot;blue&quot;, &quot;red&quot;),
                       labels=c(&quot;Observed&quot;, &quot;Predict&quot;))</code></pre>
<p><img src="{{< blogdown/postref >}}index.en_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
</div>
<div id="objetivo" class="section level2">
<h2>Objetivo</h2>
<ul>
<li>encontrar modelos que possam ajustar a esses dados</li>
<li>buscar parcerias</li>
<li>publicação</li>
</ul>
</div>
